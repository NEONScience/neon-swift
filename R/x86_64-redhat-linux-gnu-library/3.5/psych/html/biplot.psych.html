<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Draw biplots of factor or component scores by factor or...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for biplot.psych {psych}"><tr><td>biplot.psych {psych}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Draw biplots of factor or component scores by factor or component loadings</h2>

<h3>Description</h3>

<p>Extends the biplot function to the output of <code><a href="fa.html">fa</a></code>, <code><a href="deprecated.html">fa.poly</a></code>  or <code><a href="principal.html">principal</a></code>. Will plot factor scores and factor loadings in the same graph.  If the number of factors &gt; 2, then all pairs of factors are plotted. Factor score histograms are plotted on the diagonal. The input is the resulting object from <code><a href="fa.html">fa</a></code>, <code><a href="principal.html">principal</a></code>, or }code{linkfa.poly with the scores=TRUE option. Points may be colored according to other criteria.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'psych'
biplot(x, labels=NULL,cex=c(.75,1),main="Biplot from fa",
hist.col="cyan",xlim.s=c(-3,3),ylim.s=c(-3,3),xlim.f=c(-1,1),ylim.f=c(-1,1),
maxpoints=100,adjust=1.2,col,pos, arrow.len = 0.1,pch=16,choose=NULL,
cuts=1,cutl=.0,group=NULL,smoother=FALSE,vars=TRUE,...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>The output from <code><a href="fa.html">fa</a></code>, <code><a href="deprecated.html">fa.poly</a></code> or <code><a href="principal.html">principal</a></code>  with the scores=TRUE option</p>
</td></tr>
<tr valign="top"><td><code>labels</code></td>
<td>
<p>if NULL, draw the points with the plot character (pch) specified. 
To identify the data points, specify labels= 1:n  where n is the number of 
observations, or labels =rownames(data) where data was the data set analyzed
by the factor analysis.</p>
</td></tr>
<tr valign="top"><td><code>cex</code></td>
<td>
<p>A vector of plot sizes of the data labels and of the factor labels</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>A main title for a two factor biplot</p>
</td></tr>
<tr valign="top"><td><code>hist.col</code></td>
<td>
<p>If plotting more than two factors, the color of the histogram of the factor scores</p>
</td></tr>
<tr valign="top"><td><code>xlim.s</code></td>
<td>
<p>x limits of the scores. Defaults to plus/minus three sigma</p>
</td></tr>
<tr valign="top"><td><code>ylim.s</code></td>
<td>
<p>y limits of the scores.Defaults to plus/minus three sigma</p>
</td></tr>
<tr valign="top"><td><code>xlim.f</code></td>
<td>
<p>x limits of the factor loadings.Defaults to plus/minus 1.0</p>
</td></tr>
<tr valign="top"><td><code>ylim.f</code></td>
<td>
<p>y limits of the factor loadings.Defaults to plus/minus 1.0</p>
</td></tr>
<tr valign="top"><td><code>maxpoints</code></td>
<td>
<p>When plotting 3 (or more) dimensions, at what size should we switch 
from plotting &quot;o&quot; to plotting &quot;.&quot;</p>
</td></tr>
<tr valign="top"><td><code>adjust</code></td>
<td>
<p>an adjustment factor in the histogram</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>a vector of colors for the data points and for the factor loading labels</p>
</td></tr>
<tr valign="top"><td><code>pos</code></td>
<td>
<p>If plotting labels, what position should they be in? 1=below, 2=left,
3 top, 4 right.
If missing, then the assumption is that labels should be printed instead of data points.</p>
</td></tr>
<tr valign="top"><td><code>arrow.len</code></td>
<td>
<p> the length of the arrow head</p>
</td></tr>
<tr valign="top"><td><code>pch</code></td>
<td>
<p>The plotting character to use.  pch=16 gives reasonable size dots.
pch=&quot;.&quot; gives tiny points.  If adding colors, use pch between 21 and 25. 
(see examples).</p>
</td></tr>
<tr valign="top"><td><code>choose</code></td>
<td>
<p>Plot just the specified factors</p>
</td></tr>
<tr valign="top"><td><code>cuts</code></td>
<td>
<p>Do not label cases with abs(factor scores) &lt; cuts) (Actually,
the  distance of the x and y scores from 0) </p>
</td></tr>
<tr valign="top"><td><code>cutl</code></td>
<td>
<p>Do not label variables with communalities in the two space &lt; cutl</p>
</td></tr>
<tr valign="top"><td><code>group</code></td>
<td>
<p>A vector of a grouping variable for the scores.  Show a different color 
and symbol for each group.</p>
</td></tr>
<tr valign="top"><td><code>smoother</code></td>
<td>
<p>If TRUE then do a smooth scatter plot (which shows the density rather than the data points). Only useful for large data sets.</p>
</td></tr>
<tr valign="top"><td><code>vars</code></td>
<td>
<p>If TRUE, draw arrows for the variables, and plot the scores.  If FALSE, then draw arrows for the scores and plot the variables.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>more options for graphics</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the generic biplot function to take the output of a factor analysis <code><a href="fa.html">fa</a></code>, <code><a href="deprecated.html">fa.poly</a></code> or principal components analysis <code><a href="principal.html">principal</a></code> and plot the factor/component scores along with the factor/component loadings.
</p>
<p>This is an extension of the generic biplot function to allow more control over plotting points in a two space and also to plot three or more factors (two at time).  
</p>
<p>This will work for objects produced by <code><a href="fa.html">fa</a></code>, <code><a href="deprecated.html">fa.poly</a></code> or <code><a href="principal.html">principal</a></code>  if they applied to the original data matrix.  If however, one has a correlation matrix based upon the output from <code><a href="tetrachor.html">tetrachoric</a></code> or <code><a href="tetrachor.html">polychoric</a></code>, and has done either <code><a href="fa.html">fa</a></code> or <code><a href="principal.html">principal</a></code> on the correlations, then obviously, we can not do a biplot.  However, both of those functions produce a weights matrix, which, in combination with the original data can be used to find the scores by using <code><a href="factor.scores.html">factor.scores</a></code>.  Since biplot.psych is looking for two elements of the x object: x$loadings and x$scores, you can create the appropriate object to plot. See the third example.
</p>


<h3>Author(s)</h3>

<p>William Revelle</p>


<h3>See Also</h3>

<p><code><a href="fa.html">fa</a></code>, <code><a href="deprecated.html">fa.poly</a></code>,  <code><a href="principal.html">principal</a></code>, <code><a href="cluster.plot.html">fa.plot</a></code>, <code><a href="pairs.panels.html">pairs.panels</a></code>
</p>


<h3>Examples</h3>

<pre>
#the standard example
data(USArrests)
fa2 &lt;- fa(USArrests,2,scores=TRUE)
biplot(fa2,labels=rownames(USArrests))

# plot the 3 factor solution
#data(bfi)
fa3 &lt;- fa(psychTools::bfi[1:200,1:15],3,scores=TRUE)
biplot(fa3)
#just plot factors 1 and 3 from that solution
biplot(fa3,choose=c(1,3))

#
fa2 &lt;- fa(psychTools::bfi[16:25],2)  #factor analysis
fa2$scores &lt;- fa2$scores[1:100,]  #just take the first 100
#now plot with different colors and shapes for males and females
biplot(fa2,pch=c(24,21)[psychTools::bfi[1:100,"gender"]],
group =psychTools::bfi[1:100,"gender"],
   main="Biplot of Conscientiousness and Neuroticism by gender")


r &lt;- cor(psychTools::bfi[1:200,1:10], use="pairwise") #find the correlations
f2 &lt;- fa(r,2) 
x &lt;- list() 
x$scores &lt;- factor.scores(psychTools::bfi[1:200,1:10],f2)
x$loadings &lt;- f2$loadings
class(x) &lt;- c('psych','fa')
biplot(x,main="biplot from correlation matrix and factor scores")

</pre>

<hr /><div style="text-align: center;">[Package <em>psych</em> version 1.9.12 <a href="00Index.html">Index</a>]</div>
</body></html>
